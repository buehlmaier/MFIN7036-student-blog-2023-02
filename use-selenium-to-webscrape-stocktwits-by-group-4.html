<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="MFIN7036 Students 2023" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", Progress Report, " />

<meta property="og:title" content="Use Selenium to webscrape StockTwits (by &#34;Group 4&#34;) "/>
<meta property="og:url" content="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/use-selenium-to-webscrape-stocktwits-by-group-4.html" />
<meta property="og:description" content="By Group 4 StockTwits is a social network for investors and traders to share ideas and commentary in real-time. In this task, we want to webscrape the comments for the top 100 stocks in the healthcare industry in the S&amp;P 500 index in the past three months. Since the …" />
<meta property="og:site_name" content="MFIN7036 Student Blog 2023" />
<meta property="og:article:author" content="MFIN7036 Students 2023" />
<meta property="og:article:published_time" content="2023-03-17T23:19:00+08:00" />
<meta name="twitter:title" content="Use Selenium to webscrape StockTwits (by &#34;Group 4&#34;) ">
<meta name="twitter:description" content="By Group 4 StockTwits is a social network for investors and traders to share ideas and commentary in real-time. In this task, we want to webscrape the comments for the top 100 stocks in the healthcare industry in the S&amp;P 500 index in the past three months. Since the …">

        <title>Use Selenium to webscrape StockTwits (by &#34;Group 4&#34;)  · MFIN7036 Student Blog 2023
</title>
        <link href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="MFIN7036 Student Blog 2023 - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/"><span class=site-name>MFIN7036 Student Blog 2023</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://buehlmaier.github.io/MFIN7036-student-blog-2023-02
                                    >Home</a>
                                </li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/categories.html">Categories</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/tags.html">Tags</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/use-selenium-to-webscrape-stocktwits-by-group-4.html">
                Use Selenium to webscrape StockTwits (by "Group 4")
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>By Group 4</p>
<p>StockTwits is a social network for investors and traders to share ideas and commentary in real-time.
In this task, we want to webscrape the comments for the top 100 stocks in the healthcare industry in the S&amp;P 500 index in the past three months.
Since the comments are dynamic, we use Selenium to webscrape the comments.
This post shows the main code first and then address some issues that may arise when using Selenium to webscrape dynamic website.</p>
<h2>Import libraries</h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">import</span> <span class="nn">openpyxl</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
</code></pre></div>

<h2>Get the list of symbols</h2>
<div class="highlight"><pre><span></span><code><span class="n">symbol_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\STUDY\hku fintech\M4 7036 Text Analytics and Natural Language Processing in Finance and Fintech\healthcare_top100.csv&#39;</span><span class="p">)</span>
<span class="n">symbol_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">symbol_data</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">])</span>
<span class="n">name_List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">symbol_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="n">data_path</span><span class="o">=</span><span class="s1">&#39;D:\STUDY\hku fintech\M4 7036 Text Analytics and Natural Language Processing in Finance and Fintech\data4.xlsx&#39;</span>
</code></pre></div>

<h2>Write to Excel</h2>
<p>We store the data in an excel file in the following format:</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Time</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>2021-11-30 23:59:59</td>
<td>This is a comment</td>
</tr>
</tbody>
</table>
<p>We use openpyxl to write the data to an excel file.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_excel</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">list_title</span><span class="p">):</span>
    <span class="n">index</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">workbook</span><span class="o">=</span><span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">sheet</span><span class="o">=</span><span class="n">workbook</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="n">sheet</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">list_title</span><span class="p">,</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">workbook</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>

<h2>Main Process</h2>
<p>The main process is to get the comments for each symbol. 
The url of the website is https://stocktwits.com/symbol/{symbol}, where {symbol} is the symbol of the stock.
We use Selenium to webscrape the website.
For each symbol, we get the time and the text of the comment.
Then we store the data in a list and write the data to an excel file.
Then we move to the next symbol until all the symbols are processed.
If the time of the comment is later than the time we want, we stop the process.
The code is shown below.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">symbol</span><span class="p">):</span>
    <span class="n">driver_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:</span><span class="se">\\</span><span class="s1">STUDY</span><span class="se">\\</span><span class="s1">selenium</span><span class="se">\\</span><span class="s1">chromedriver.exe&#39;</span> <span class="c1"># path to the chromedriver</span>
    <span class="n">option</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span> <span class="c1"># create a ChromeOptions object</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;detach&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># make the browser stay open</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s1">&#39;excludeSwitches&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;enable-logging&#39;</span><span class="p">])</span> <span class="c1"># disable the warning</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Service</span><span class="p">(</span><span class="n">driver_path</span><span class="p">)</span> <span class="c1"># create a Service object</span>
    <span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">s</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="n">option</span><span class="p">)</span> <span class="c1"># create a Chrome object</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#for symbol in symbol_list[:3]:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://stocktwits.com/symbol/</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># url of the website</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> 
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">text_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># count the number of comments retrieved in one page</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># count the number of comments retrieved in total</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">text1</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span> <span class="c1"># store the text of the comment</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># find the time of the comment by XPATH</span>
            <span class="n">time_text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[2]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[1]/a/time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">time_text</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="k">try</span><span class="p">:</span> <span class="c1"># if the element is not found, try the other possible XPATH</span>
                <span class="n">time_text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[3]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[1]/a/time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">time_text</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="c1"># if the element is not found, print the index of the comment</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time_text&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="n">text1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Nov&#39;</span><span class="p">):</span> <span class="c1"># if the comment is posted in November, stop the loop</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># find the text of the comment by XPATH</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[2]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[3]/div[1]/div/div&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">text1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">text_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> <span class="c1"># if the element is not found, try the other possible XPATH</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[3]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[3]/div[1]/div/div&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">text1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="n">text_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="c1"># if the element is not found, print the index of the comment</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;article&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span> <span class="c1"># To load more comments, every 15 comments, scroll down the page</span>
            <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;window.scrollTo(0,document.body.scrollHeight)&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">write_excel</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">text_list</span><span class="p">,</span><span class="n">symbol</span><span class="p">)</span> <span class="c1"># write the data to an excel file</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># close the browser</span>
</code></pre></div>

<h2>Main function and time cost of the program</h2>
<p>We use multiprocessing to run the program in parallel to speed up the process.
The code is shown below.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">pool</span><span class="o">=</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MRNA&#39;</span><span class="p">]:</span> <span class="c1">#symbol_list:</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">process</span><span class="p">,(</span><span class="n">item</span><span class="p">,))</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="c1">#print(text_list)   </span>
    <span class="c1">#dict_result[symbol_list[index]] = text_list</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span> <span class="c1"># run the program</span>
    <span class="n">start</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">main</span><span class="p">()</span>
    <span class="n">end</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>
</code></pre></div>

<h2>Note for Selenium</h2>
<h3>Detach the browser and disable the warning</h3>
<p>The browser will be closed automatically after the program is finished.
To keep the browser open, we need to detach the browser.
Also, warning messages will be displayed when the browser is detached.
To make the result readable, we need to disable the warning.</p>
<div class="highlight"><pre><span></span><code><span class="n">option</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span> <span class="c1">#create a ChromeOptions object</span>
<span class="n">option</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;detach&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># make the browser stay open</span>
<span class="n">option</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s1">&#39;excludeSwitches&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;enable-logging&#39;</span><span class="p">])</span> <span class="c1"># disable the warning</span>
</code></pre></div>

<h3>Dynamic loading</h3>
<p>For dynamic website, the comments are loaded dynamically, 
which means that the comments are loaded when the page is scrolled down.
Selenium provides a method to scroll down the page.
The maximum number of comments that can be loaded in one page is around 20.
We use a counter to count the number of comments retrieved in one page.
When the counter reaches 15, we scroll down the page to load more comments.
In this way, we can retrieve all the comments in the page.</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span> <span class="c1"># Scroll down the page to load more comments every 15 comments</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;window.scrollTo(0,document.body.scrollHeight)&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># reset the counter</span>
</code></pre></div>

<h3>Prevent blocking</h3>
<p>Some websites use anti-scraping techniques to prevent webscraping.
For StockTwits, we need to add a delay between each request.
Otherwise, the website will block our requests.
We use browser.implicitly_wait() and time module to add a delay between each request.</p>
<div class="highlight"><pre><span></span><code><span class="n">browser</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># wait for 20 seconds</span>
</code></pre></div>

<p>or</p>
<div class="highlight"><pre><span></span><code><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<h3>Find the element</h3>
<p>In Selenium.By module, there are several ways to find the element.
In this task, we find the element by XPATH. In the browser, we can right-click the element and select "Copy XPATH" to get the XPATH of the element.</p>
<p>We can use the following code to find the element.</p>
<div class="highlight"><pre><span></span><code><span class="n">time_text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[2]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[1]/a/time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</code></pre></div>

<p>In this task, the XPATH of the element is dynamic. Therefore, we use try-except to find the element by different XPATH.
If the element is not found, we print the index of the comment.</p>
<div class="highlight"><pre><span></span><code><span class="n">text1</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span> <span class="c1"># store the text of the comment</span>
<span class="k">try</span><span class="p">:</span> <span class="c1"># find the time of the comment by XPATH</span>
    <span class="n">time_text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[2]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[1]/a/time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<span class="k">except</span><span class="p">:</span> 
    <span class="k">try</span><span class="p">:</span> <span class="c1"># if the element is not found, try the other possible XPATH</span>
        <span class="n">time_text</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/div/div[2]/div[2]/div[3]/div/div/div/div[3]/div/div/div[2]/div/div/div/div[6]/div[3]/div[1]/div/article[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]/div/div[1]/a/time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">except</span><span class="p">:</span> <span class="c1"># if the element is not found, print the index of the comment</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time_text&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="n">text1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_text</span><span class="p">)</span>
</code></pre></div>

<h2>Result</h2>
<p>The head of the data is shown below.</p>
<p><img alt="Wechat" src="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/images/Group4-Post02_WechatIMG51.jpg"></p>
<h2>Conclusion</h2>
<p>For dynamic website, several issues may arise when using Selenium to webscrape the website. The above code can be used to solve these problems.</p>
<p>The next step is to clean the data and do some analysis. Thanks for reading!</p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2023-03-17T23:19:00+08:00">Fri 17 March 2023</time>
            <h4>Category</h4>
            <a class="category-link" href="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/categories.html#progress-report-ref">Progress Report</a>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/buehlmaier/MFIN7036-student-blog-2023-02" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://buehlmaier.github.io/MFIN7036-student-blog-2023-02/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>